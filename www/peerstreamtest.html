<!DOCTYPE html>
<html>
  <head>
    <title>PeerStream Demo</title>
    <script type="text/javascript" src="js/peer.js"></script>
    <script type="text/javascript" src="js/peerstream.js"></script>
    <script>

      function connect() {
        var selfId = document.getElementById("selfId").value;
        var peerId = document.getElementById("peerId").value;
        PeerStream.connect(selfId, peerId, "audio_player");
      }

      function sendMessage() {
        var msg = document.getElementById("message").value;
        PeerStream.chat(msg);
      }

      PeerStream.onConnected(function(){
        console.log('connected');
      });
      PeerStream.onDisconnected(function(){
        console.log('dis-connected');
      });
      PeerStream.onPeerConnected(function(){
       console.log('peer connected');
      });
      PeerStream.onPeerDisconnected(function(){
       console.log('peer dis-connected');
      });
      PeerStream.onChat(function(chatMessage){
       console.log('chat : '+chatMessage);
      });
      PeerStream.onError(function(err){
       console.log('error :' + JSON.stringify(err));
      });

      function handleFileSelect(fileObj) {
        var files = fileObj.files;
        PeerStream.attachSource("file",files[0]);
      }
    </script>
  </head>
  <body>
    <h2>PeerStream Demo !!! </h2>
    selfId:<input type = "text" id="selfId"/>
    <br>
    peerId:<input type = "text" id="peerId"/>
    <br>
    <button onclick="connect()">Connect me</button>
    <br>
    Message:<input type = "text" id="message"/><button onclick="sendMessage()">Send message</button>
    <div>
      <input type="file" id="selectedFile" style="display: none;" accept="audio/*" onchange="handleFileSelect(this)"/>
      <input type="button" value="Choose song" onclick="document.getElementById('selectedFile').click();" style="height: 50px;width:80%;max-width: 250px;"/>
      <br/><br/>
      <audio controls id="audio_player" style="width:80%;max-width: 250px;"/>
    </div>
  </body>
</html>
